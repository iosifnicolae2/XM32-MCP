# X32/M32 OSC Protocol 실제 예제

이 문서는 X32/M32 OSC 프로토콜의 실제 사용 예제를 다룹니다.

## Float 타입 상세 예제

### Volume Fader 제어

채널 01의 볼륨을 3dB로 설정하는 예제:

**OSC 표준 표기 (0.0 ~ 1.0 범위):**

```
/ch/01/mix/fader~~~,f~~[0.8250]
```

**16진수 표현:**

```
2f63682f30312f6d69782f66616465720000002c6600003f5334cd
```

분해:

- `2f63682f30312f6d69782f6661646572000000`: `/ch/01/mix/fader` + padding
- `2c660000`: `,f` + padding
- `3f5334cd`: 0.8250의 32-bit float (big-endian)

### Pan 제어

채널 02의 팬을 "half right" (우측 50%)로 설정:

**OSC 표준 표기:**

```
/ch/02/mix/pan~~,f~~[0.7500]
```

**16진수 표현:**

```
2f63682f30322f6d69782f70616e00002c6600003f400000
```

분해:

- `2f63682f30322f6d69782f70616e0000`: `/ch/02/mix/pan` + padding
- `2c660000`: `,f` + padding
- `3f400000`: 0.7500의 32-bit float (big-endian)

## X32node 스타일 표기법

Float는 **표준 OSC 명령**에서는 [0.0 ~ 1.0] 범위로 매핑되지만, **X32node 스타일 명령**에서는 **실제 값 범위**를 사용할 수 있습니다.

### Volume Fader를 X32node 스타일로 설정

채널 01 볼륨을 3dB로 설정 (실제 범위 사용):

```
/~~~,s~~ch/01/mix/fader 3~~
```

**16진수 표현:**

```
2f0000002c7300002f63682f30312f6d69782f666164657220666616465722203313000
```

**볼륨 범위**: [-90dB, +10dB, 1024단계] → 유사 로그 스케일 (-90dB ~ +10dB)

**추가 예제들:**

| 목표 dB  | Float 값 (OSC) | 16진수 (Float 부분) | X32node 표기 |
| -------- | -------------- | ------------------- | ------------ |
| +10 dB   | 1.0            | `3f800000`          | `10`         |
| 0 dB     | ~0.75          | (varies)            | `0`          |
| -5 dB    | ~0.72          | `2d3500`            | `-5`         |
| -90 dB   | 0.0            | `00000000`          | `-90`        |
| -20.5 dB | ~0.63          | `2d32302e35`        | `-20.5`      |

**명령 예제:**

```
/~~~,s~~ch/01/mix/fader 10~        # +10dB
/~~~,s~~ch/01/mix/fader 0~~        # 0dB
/~~~,s~~ch/01/mix/fader -5~        # -5dB
/~~~,s~~ch/01/mix/fader -90~~~~    # -90dB (최소)
/~~~,s~~ch/01/mix/fader -20.5~~    # -20.5dB
```

### Pan을 X32node 스타일로 설정

채널 02 팬을 "right, 50% level"로 설정:

```
/~~~,s~~ch/02/mix/pan 50~~
```

**16진수 표현:**

```
2f0000002c7300002f63682f30322f6d69782f70616e203530353400000
```

**팬 범위**: [-100.0, +100.0, 2.0 단계] → 선형 스케일

- `-100.0`: 완전 좌측
- `0.0`: 센터
- `+100.0`: 완전 우측
- 단계: 2.0 (예: -100, -98, -96, ..., 0, ..., 98, 100)

## 복수 인자 명령 예제

### EQ 설정 (복수 파라미터)

채널 01의 EQ 밴드 1 설정:

**단일 명령 (권장):**

```
/ch/01/eq/1 ,ifff [2] [0.2650] [0.5000] [0.4648]
```

**분리된 명령 (동일한 효과):**

```
/ch/01/eq/1/t~~~,i~~[2]          # Type (enum: 2)
/ch/01/eq/1/f~~~,f~~[0.2650]     # Frequency
/ch/01/eq/1/g~~~,f~~[0.5000]     # Gain
/ch/01/eq/1/q~~~,f~~[0.4648]     # Q factor
```

**16진수 표현 (마지막 Q factor 명령):**

```
/  c  h  /  0  1  /  e  q  /  1  /  q  ~  ~  ~  ,  f  ~  ~ [0.4648]
2f 63 68 2f 30 31 2f 65 71 2f 31 2f 71 00 00 00 2c 66 00 00 3eedfa44
```

파라미터 분해:

- **Type (t)**: Integer, EQ 타입 (0=LCut, 1=LShv, 2=PEQ, 3=VEQ, 4=HShv, 5=HCut)
- **Frequency (f)**: Float, 주파수 (20Hz ~ 20kHz, 201단계)
- **Gain (g)**: Float, 게인 (-15dB ~ +15dB)
- **Q factor (q)**: Float, Q 값 (0.3 ~ 10.0)

## Enum 타입 예제

### 문자열로 Enum 전송

Gate 모드를 "GATE"로 설정:

```
/ch/01/gate/mode~~~~,s~~GATE~~~~
```

**16진수:**

```
2f63682f30312f676174652f6d6f6465000000002c7300004741544500000000
```

분해:

- `2f63682f30312f676174652f6d6f6465000000`: `/ch/01/gate/mode` + padding
- `2c730000`: `,s` + padding
- `47415445`: "GATE" (ASCII)
- `00000000`: null termination + padding

### 정수로 Enum 전송

동일한 명령을 정수 인덱스로:

```
/ch/01/gate/mode~~~~,i~~[3]
```

**16진수:**

```
2f63682f30312f676174652f6d6f6465000000002c69000000000003
```

분해:

- `2f63682f30312f676174652f6d6f6465000000`: `/ch/01/gate/mode` + padding
- `2c690000`: `,i` + padding
- `00000003`: integer 3 (big-endian)

**Enum 값:**

- `0`: EXP2
- `1`: EXP3
- `2`: EXP4
- `3`: GATE
- `4`: DUCK

## X32/M32 응답 예제

### /info 응답 상세

**요청:**

```
/info~~~,~~~
```

**X32 Standard 응답:**

```
/info~~~,ssss~~~V2.05~~~osc-server~~X32~2.10~~~~
```

**16진수 분해:**

```
2f696e666f000000                    # /info + padding
2c73737373000000                    # ,ssss + padding
5632 2e30 3500 0000                 # "V2.05" + null + padding
6f73 632d 7365 7276 6572 0000      # "osc-server" + null + padding
5833 3200 0000 0000                 # "X32" + null + padding
322e 3130 0000 0000                 # "2.10" + null + padding
```

### /status 응답 상세

**요청:**

```
/status~,~~~
```

**응답:**

```
/status~,sss~~~~active~~192.168.0.64~~~~osc-server~~
```

**16진수 분해:**

```
2f73746174757300                    # /status + padding
2c737373000000                      # ,sss + padding
6163746976650000                    # "active" + null + padding
3139322e3136382e302e363400000000   # "192.168.0.64" + null + padding
6f73632d7365727665720000           # "osc-server" + null + padding
```

### 파라미터 Get/Set 응답

**Get 요청:**

```
/fx/4/par/23~~~~,~~~
```

**응답:**

```
/fx/4/par/23~~~~,f~~[0.5]
```

**16진수 (응답):**

```
/  f  x  /  4  /  p  a  r  /  2  3  ~  ~  ~  ~  ,  f  ~  ~ [0.5]
2f 66 78 2f 34 2f 70 61 72 2f 32 33 00 00 00 00 2c 66 00 00 3f000000
```

분해:

- `2f66782f342f7061722f3233000000`: `/fx/4/par/23` + padding
- `2c660000`: `,f` + padding
- `3f000000`: 0.5의 32-bit float (big-endian)

## 구독(Subscribe) 예제

### 기본 구독

Solo 스위치 상태 구독 (채널 01):

```
/subscribe ,si /-stat/solosw/01 1
```

**서버 응답 (10초 동안 약 200회):**

```
/-stat/solosw/01~~~~,i~~[0]
/-stat/solosw/01~~~~,i~~[1]
/-stat/solosw/01~~~~,i~~[0]
...
```

### 낮은 빈도 구독

```
/subscribe ,si /-stat/solosw/01 50
```

**서버 응답 (10초 동안 약 4회):**

```
/-stat/solosw/01~~~~,i~~[1]
(2.5초 후)
/-stat/solosw/01~~~~,i~~[1]
(2.5초 후)
/-stat/solosw/01~~~~,i~~[0]
(2.5초 후)
/-stat/solosw/01~~~~,i~~[0]
```

## /xremote 예제

### 자동 업데이트 등록

**등록 요청:**

```
/xremote~~~,~~~
```

**자동 푸시 (페이더 이동 시):**

```
/ch/01/mix/fader~~~,f~~[0.7500]
/ch/01/mix/fader~~~,f~~[0.7510]
/ch/01/mix/fader~~~,f~~[0.7520]
...
```

**자동 푸시 (뮤트 토글 시):**

```
/ch/01/mix/on~~~,i~~[0]
/-stat/solosw/01~~~~,i~~[0]
```

**자동 푸시 (채널 이름 변경 시):**

```
/ch/01/config/name~~,s~~Vocal~~~~
```

## X32node 명령 예제

### Node 데이터 읽기

**요청:**

```
/node~~~,s~~ch/01~~~~
```

**응답:**

```
node~~~,s~~ch/01 "Vocal" 10 CY 1~~~~
```

응답 파라미터:

- `ch/01`: 노드 경로
- `"Vocal"`: 채널 이름
- `10`: 아이콘 번호
- `CY`: 색상 코드 (Cyan/Yellow)
- `1`: 소스 번호

### Node 데이터 쓰기

**단일 파라미터 업데이트:**

```
/~~~,s~~ch/01 NewName~~~~
```

**전체 설정 업데이트:**

```
/~~~,s~~ch/01 "Guitar" 15 RD 2~~~~
```

## 유용한 변환 테이블

### Float → dB 변환 (Volume Fader)

| Float | dB              | 사용 케이스 |
| ----- | --------------- | ----------- |
| 0.00  | -∞ (또는 -90dB) | 완전 음소거 |
| 0.25  | ~-60dB          | 매우 작음   |
| 0.50  | ~-30dB          | 작음        |
| 0.75  | ~0dB            | Unity gain  |
| 0.82  | ~+3dB           | 약간 크게   |
| 1.00  | +10dB           | 최대        |

### Float → Pan 변환

| Float | Pan Position | 설명      |
| ----- | ------------ | --------- |
| 0.00  | -100 (L100)  | 완전 좌측 |
| 0.25  | -50 (L50)    | 좌측 50%  |
| 0.50  | 0 (C)        | 센터      |
| 0.75  | +50 (R50)    | 우측 50%  |
| 1.00  | +100 (R100)  | 완전 우측 |

## 참고 사항

### X32/M32 "node" 명령 특별 규칙

X32/M32 "node" 명령에서 문자열(,s)을 node 주소로 보내면 다른 방식으로 해석됩니다 (X32-edit 내부용).

따라서 다음 명령은:

```
/ch/[01..32]/config ,siii [name] [1] [3] [1]
```

의미적으로는 올바르고 OSC 준수이지만, **X32/M32에서는 작동하지 않습니다**.

이는 **XAir 시리즈에서는 정상 작동**합니다.

**올바른 방법 (X32/M32):**

```
/ch/01/config/name ,s Vocal
/ch/01/config/icon ,i 1
/ch/01/config/color ,i 3
/ch/01/config/source ,i 1
```

또는 X32node 스타일:

```
/~~~,s~~ch/01/config Vocal 1 3 1
```

## 디버깅 팁

### 16진수 덤프 해석

OSC 메시지를 16진수로 디버깅할 때:

1. **주소 찾기**: `/` (2f)로 시작
2. **Type tag 찾기**: `,` (2c)로 시작
3. **4-byte 경계 확인**: 00으로 패딩된 부분 확인
4. **Float 값**: 항상 4 bytes (예: 3f000000 = 0.5)
5. **Integer 값**: 항상 4 bytes (예: 00000001 = 1)
6. **String 값**: null-terminated, 4-byte 정렬

### 일반적인 실수

1. **Type tag 누락**: `/info` 대신 `/info~~~,~~~` 사용 권장
2. **Float 범위 초과**: 0.0~1.0 범위 외의 값 사용
3. **패딩 누락**: 4-byte 정렬 미준수
4. **Endianness 실수**: Little-endian 대신 big-endian 사용 필수
5. **String null termination 누락**: 문자열 끝에 \0 필수

## 참고 자료

- [OSC-Protocal.md](../OSC-Protocal.md) - OSC 프로토콜 핵심 가이드
- [client-initiated-messages.md](./client-initiated-messages.md) - 클라이언트 메시지 목록
- [server-replies.md](./server-replies.md) - 서버 응답 목록
- [X32-OSC-Protocol-Summary.md](../X32-OSC-Protocol-Summary.md) - 전체 프로토콜 요약
